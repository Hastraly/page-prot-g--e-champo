<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Accéder au site Mon E-Champo</title>
    <style>
        body { 
            font-family: Arial, sans-serif; 
            background-color: #f5f5f5; 
            height: 100vh; 
            display: flex; 
            justify-content: center; 
            align-items: center; 
        }
        .container {
            background: white;
            padding: 30px;
            border-radius: 12px;
            box-shadow: 0 4px 18px rgba(0,0,0,0.1);
            text-align: center;
            width: 300px;
        }
        input {
            width: 100%;
            padding: 10px;
            margin-top: 10px;
            border-radius: 6px;
            border: 1px solid #aaa;
            font-size: 16px;
        }
        button {
            width: 100%;
            padding: 10px;
            margin-top: 10px;
            background-color: #007bff;
            border: none;
            border-radius: 6px;
            color: white;
            cursor: pointer;
            font-size: 16px;
        }
        button:hover {
            background-color: #0056b3;
        }
        .error {
            color: red;
            margin-top: 10px;
            display: none;
        }
    </style>
</head>
    <!-- Début : Bandeau Cookies / RGPD -->
<style>
  /* Conteneur bandeau */
  #cookie-consent {
    position: fixed;
    left: 20px;
    right: 20px;
    bottom: 20px;
    background: #fff;
    border-radius: 10px;
    box-shadow: 0 6px 24px rgba(0,0,0,0.12);
    padding: 18px;
    display: none;
    z-index: 9999;
    font-family: Arial, sans-serif;
    max-width: 400px;
    width: 90%;
  }

  /* Texte et liens */
  #cookie-consent p, #cookie-consent strong {
    margin: 0;
    color: #222;
    font-size: 14px;
  }
  #cookie-consent a {
    color: #007bff;
    text-decoration: underline;
  }

  /* Zone de boutons */
  .actions {
    display: flex;
    flex-wrap: wrap; /* permet aux boutons de passer à la ligne sur petit écran */
    gap: 8px;
    margin-top: 10px;
    justify-content: flex-start;
  }
  .actions button {
    flex: 1 1 auto;
    padding: 10px;
    border-radius: 6px;
    border: 1px solid #ccc;
    cursor: pointer;
    background: #e8e8e8;
    color: #111;
  }
  .actions button.primary {
    background: #007bff;
    color: #fff;
    border-color: transparent;
  }

  /* Paramétrage cookies */
  #cookie-settings {
    display: none;
    margin-top: 10px;
    border-top: 1px solid #eee;
    padding-top: 10px;
  }
  #cookie-settings label {
    display: flex;
    align-items: center;
    gap: 8px;
    margin: 6px 0;
    font-size: 13px;
  }
</style>

<div id="cookie-consent" role="dialog" aria-live="polite" aria-label="Bannière cookies">
  <div>
    <strong>Nous utilisons des cookies</strong>
    <p>
      Pour améliorer l'expérience et analyser l'utilisation du site. Vous pouvez accepter tous les cookies, les refuser ou choisir quelles catégories autoriser.
      <a href="/politique-confidentialite.html" target="_blank" rel="noopener">En savoir plus</a>
    </p>

    <div id="cookie-settings" aria-hidden="true">
      <label><input type="checkbox" id="cookie-necessary" checked disabled> Cookies strictement nécessaires</label>
      <label><input type="checkbox" id="cookie-stats"> Cookies d'analyse</label>
      <label><input type="checkbox" id="cookie-marketing"> Cookies marketing</label>
    </div>

    <div class="actions">
      <button id="btn-manage">Paramétrer</button>
      <button id="btn-refuse">Refuser</button>
      <button id="btn-accept" class="primary">Accepter</button>
    </div>
  </div>
</div>

<script>
(function() {
  const BANNER_ID = 'cookie-consent';
  const LS_KEY = 'cookie_consent_v1';
  const banner = document.getElementById(BANNER_ID);
  const settings = document.getElementById('cookie-settings');
  const btnManage = document.getElementById('btn-manage');
  const btnRefuse = document.getElementById('btn-refuse');
  const btnAccept = document.getElementById('btn-accept');

  // Vérifier si le consentement a déjà été donné
  const saved = localStorage.getItem(LS_KEY);
  const consent = saved ? JSON.parse(saved) : null;

  function applyConsent(c) {
    if (c && c.stats) {
      loadAnalytics(); // exemple : charger Google Analytics si accepté
    }
  }

  function loadAnalytics() {
    if (window._gaLoaded) return;
    window._gaLoaded = true;
    const s = document.createElement('script');
    s.async = true;
    s.src = 'https://www.googletagmanager.com/gtag/js?id=G-XXXXXXXXXX'; // <-- remplace par ton ID
    document.head.appendChild(s);
    s.onload = function() {
      window.dataLayer = window.dataLayer || [];
      function gtag(){ dataLayer.push(arguments); }
      window.gtag = gtag;
      gtag('js', new Date());
      gtag('config', 'G-XXXXXXXXXX', { anonymize_ip: true });
    };
  }

  if (!consent) {
    banner.style.display = 'block';
  } else {
    applyConsent(consent);
  }

  btnManage.addEventListener('click', function() {
    settings.style.display = settings.style.display === 'block' ? 'none' : 'block';
    settings.setAttribute('aria-hidden', settings.style.display !== 'block' ? 'true' : 'false');
  });

  btnRefuse.addEventListener('click', function() {
    const c = { necessary: true, stats: false, marketing: false, timestamp: Date.now() };
    localStorage.setItem(LS_KEY, JSON.stringify(c));
    banner.style.display = 'none';
    applyConsent(c);
  });

  btnAccept.addEventListener('click', function() {
    let stats = document.getElementById('cookie-stats').checked;
    let marketing = document.getElementById('cookie-marketing').checked;

    if (settings.style.display !== 'block') { // pas ouvert paramétrage
      stats = true;
      marketing = true;
    }

    const c = { necessary: true, stats: !!stats, marketing: !!marketing, timestamp: Date.now() };
    localStorage.setItem(LS_KEY, JSON.stringify(c));
    banner.style.display = 'none';
    applyConsent(c);
  });

  window.showConsentPanel = function() {
    banner.style.display = 'block';
    settings.style.display = 'block';
    settings.setAttribute('aria-hidden', 'false');
  };
})();
</script>
<!-- Fin : Bandeau Cookies / RGPD -->

<body>
    <div class="container">
        <h2>Accéder au site Mon E-Champo</h2>
        <p>Ce site est réservé aux élèves de la 2nde 10 du lycée Champollion</p>
        <input type="password" id="passwordInput" placeholder="Mot de passe">
        <button onclick="checkPassword()">Entrer</button>
        <p class="error" id="errorMsg">Mot de passe incorrect ❌</p>
    </div>

    <script>
        function checkPassword() {
            const correctPassword = "Seconde";
            const userPassword = document.getElementById("passwordInput").value;

            if (userPassword === correctPassword) {
                window.location.href = "https://sites.google.com/view/mon-e-champo/";
            } else {
                document.getElementById("errorMsg").style.display = "block";
            }
        }
    </script>
</body>
</html>
